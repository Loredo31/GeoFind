const EmailSender = require('./src/emailSender');

(async () => {
    try {
        console.log("🚀 INICIANDO TEST DE RECHAZO\n");
        
        const emailSender = new EmailSender();

        const recipientEmail = "31loredo@gmail.com"; 
        const clientName = "Ana María Rodríguez Sánchez";
        const reason = "Documentación incompleta y falta de referencias crediticias";

        console.log("📧 Enviando correo de rechazo...");
        console.log(`📍 Destinatario: ${recipientEmail}`);
        console.log(`👤 Cliente: ${clientName}`);
        console.log(`📋 Razón: ${reason}`);

        const [success, info] = await emailSender.sendRejectionEmail(
            recipientEmail, 
            clientName, 
            reason
        );

        console.log("\n" + "=".repeat(60));
        if (success) {
            console.log("🎉 TEST DE RECHAZO EXITOSO");
            console.log(`✅ ${info}`);
            console.log(`📧 Correo enviado a: ${recipientEmail}`);
            console.log(`👤 Cliente notificado: ${clientName}`);
            console.log(`📋 Razón especificada: ${reason}`);
        } else {
            console.log("❌ TEST DE RECHAZO FALLIDO");
            console.log(`❌ ${info}`);
        }
        console.log("=".repeat(60));

    } catch (err) {
        console.error("\n💥 ERROR EN TEST DE RECHAZO:");
        console.error(err.message);
        console.error(err.stack);
    }
})();