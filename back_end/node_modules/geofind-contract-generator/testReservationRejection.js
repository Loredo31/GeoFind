const EmailSender = require('./src/emailSender');

(async () => {
    try {
        console.log("ğŸš€ INICIANDO TEST DE RECHAZO\n");
        
        const emailSender = new EmailSender();

        const recipientEmail = "31loredo@gmail.com"; 
        const clientName = "Ana MarÃ­a RodrÃ­guez SÃ¡nchez";
        const reason = "DocumentaciÃ³n incompleta y falta de referencias crediticias";

        console.log("ğŸ“§ Enviando correo de rechazo...");
        console.log(`ğŸ“ Destinatario: ${recipientEmail}`);
        console.log(`ğŸ‘¤ Cliente: ${clientName}`);
        console.log(`ğŸ“‹ RazÃ³n: ${reason}`);

        const [success, info] = await emailSender.sendRejectionEmail(
            recipientEmail, 
            clientName, 
            reason
        );

        console.log("\n" + "=".repeat(60));
        if (success) {
            console.log("ğŸ‰ TEST DE RECHAZO EXITOSO");
            console.log(`âœ… ${info}`);
            console.log(`ğŸ“§ Correo enviado a: ${recipientEmail}`);
            console.log(`ğŸ‘¤ Cliente notificado: ${clientName}`);
            console.log(`ğŸ“‹ RazÃ³n especificada: ${reason}`);
        } else {
            console.log("âŒ TEST DE RECHAZO FALLIDO");
            console.log(`âŒ ${info}`);
        }
        console.log("=".repeat(60));

    } catch (err) {
        console.error("\nğŸ’¥ ERROR EN TEST DE RECHAZO:");
        console.error(err.message);
        console.error(err.stack);
    }
})();