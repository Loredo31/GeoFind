const ContractGenerator = require('./src/contractGenerator');

const generator = new ContractGenerator();

const clientData = {
    nombre: "Ana MarÃ­a RodrÃ­guez SÃ¡nchez",
    edad: "35",
    gmail: "ana.rodriguez@email.com",
    numero_telefonico: "555-987-6543",
    direccion: "Calle Secundaria 789, Colonia Centro, Guadalajara, Jalisco",
    curp: "ROSA750215JTLNDR05",
    // reference_number: "CTO-2024-002"
};

const propertyData = {
    property_address: "Casa en residencial cerrado con vigilancia 24 horas en una zona exclusiva de la ciudad",
    property_type: "Casa",
    rental_period: "24 meses",
    monthly_rent: "25000",
    deposit_amount: "25000",
    arrendador_nombre: "Carlos Eduardo Mendoza Ruiz",
    clausulas: [
        "1. DURACIÃ“N: El presente contrato tendrÃ¡ una vigencia de 24 meses renovables automÃ¡ticamente por periodos iguales salvo notificaciÃ³n por escrito de alguna de las partes con 30 dÃ­as de anticipaciÃ³n a la fecha de terminaciÃ³n.",
        "2. RENTA: El pago mensual deberÃ¡ realizarse antes del dÃ­a 5 de cada mes mediante transferencia bancaria a la cuenta especificada, considerÃ¡ndose dÃ­as inhÃ¡biles aquellos establecidos por la ley federal del trabajo.",
        "3. DEPÃ“SITO: El depÃ³sito en garantÃ­a serÃ¡ equivalente a una mensualidad de renta y serÃ¡ devuelto al tÃ©rmino del contrato, previa verificaciÃ³n del inmueble y liquidaciÃ³n total de servicios pendientes.",
        "4. MANTENIMIENTO: El arrendatario se obliga a mantener la propiedad en Ã³ptimas condiciones de limpieza y funcionamiento, realizando reparaciones menores y reportando inmediatamente cualquier daÃ±o estructural o falla en los sistemas.",
        "5. SERVICIOS: El arrendador cubre los servicios de agua y mantenimiento de Ã¡reas comunes, mientras el arrendatario cubre luz, gas, internet, televisiÃ³n por cable y demÃ¡s servicios particulares del inmueble."
    ]
};

function verifyContractRules(clientData, propertyData) {
    const rules = [];
    
    console.log("ğŸ” VERIFICANDO REGLAS DEL CONTRATO:");
    console.log("-".repeat(50));
    
    if (!clientData.nombre) rules.push("âŒ Falta nombre del arrendatario");
    else rules.push("âœ… Nombre del arrendatario: COMPLETO");
    
    if (!propertyData.property_address) rules.push("âŒ Falta direcciÃ³n de la propiedad");
    else rules.push("âœ… DirecciÃ³n de propiedad: COMPLETA");
    
    if (!propertyData.monthly_rent) rules.push("âŒ Falta renta mensual");
    else rules.push("âœ… Renta mensual: DEFINIDA");
    
    if (clientData.reference_number && !clientData.reference_number.startsWith('CTO-')) {
        rules.push("âš ï¸  Referencia no sigue formato estÃ¡ndar");
    } else {
        rules.push("âœ… Formato de referencia: CORRECTO");
    }
    
    if (propertyData.clausulas && propertyData.clausulas.length > 0) {
        rules.push(`âœ… ClÃ¡usulas personalizadas: ${propertyData.clausulas.length} ACTIVAS`);
    } else {
        rules.push("âœ… ClÃ¡usulas por defecto: ACTIVAS");
    }
    
    if (!clientData.gmail && !clientData.numero_telefonico) {
        rules.push("âš ï¸  Falta informaciÃ³n de contacto del arrendatario");
    } else {
        rules.push("âœ… InformaciÃ³n de contacto: COMPLETA");
    }
    
    if (propertyData.property_address && propertyData.property_address.length > 50) {
        rules.push("âœ… DirecciÃ³n larga: ACTIVA funciÃ³n de salto de lÃ­nea");
    }
    
    if (propertyData.clausulas && propertyData.clausulas.some(clause => clause.length > 100)) {
        rules.push("âœ… ClÃ¡usulas largas: ACTIVA funciÃ³n de texto multilÃ­nea");
    }
    
    rules.forEach(rule => console.log(`  ${rule}`));
    console.log("-".repeat(50));
    
    return rules;
}

async function generateSingleContract() {
    console.log("ğŸš€ INICIANDO GENERACIÃ“N DE CONTRATO ÃšNICO\n");
    
    verifyContractRules(clientData, propertyData);
    
    try {
        console.log("ğŸ“„ GENERANDO CONTRATO...");
        const filepath = await generator.generateRentalContract(clientData, propertyData);
        console.log(`\nğŸ‰ CONTRATO GENERADO EXITOSAMENTE:`);
        console.log(`ğŸ“ UbicaciÃ³n: ${filepath}`);
        console.log(`ğŸ“Š CaracterÃ­sticas activadas:`);
        console.log(`   â€¢ Encabezados con colores verde`);
        console.log(`   â€¢ Secciones con fondos diferenciados`);
        console.log(`   â€¢ Texto multilÃ­nea en clÃ¡usulas largas`);
        console.log(`   â€¢ Espaciado mejorado en firmas`);
        console.log(`   â€¢ Manejo de pÃ¡ginas mÃºltiples`);
        console.log(`   â€¢ Formato profesional completo`);
        
    } catch (error) {
        console.log(`\nâŒ ERROR EN LA GENERACIÃ“N:`);
        console.log(`   ${error.message}`);
    }
    
    console.log("\nğŸ PROCESO COMPLETADO");
}

generateSingleContract();